<script>
function str_replace ( search, replace, subject ) {	// Replace all occurrences of the search string with the replacement string
	// 
	// +   original by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
	// +   improved by: Gabriel Paderni

	if(!(replace instanceof Array)){
		replace=new Array(replace);
		if(search instanceof Array){//If search	is an array and replace	is a string, then this replacement string is used for every value of search
			while(search.length>replace.length){
				replace[replace.length]=replace[0];
			}
		}
	}

	if(!(search instanceof Array))search=new Array(search);
	while(search.length>replace.length){//If replace	has fewer values than search , then an empty string is used for the rest of replacement values
		replace[replace.length]='';
	}

	if(subject instanceof Array){//If subject is an array, then the search and replace is performed with every entry of subject , and the return value is an array as well.
		for(k in subject){
			subject[k]=str_replace(search,replace,subject[k]);
		}
		return subject;
	}

	for(var k=0; k<search.length; k++){
		var i = subject.indexOf(search[k]);
		while(i>-1){
			subject = subject.replace(search[k], replace[k]);
			i = subject.indexOf(search[k],i);
		}
	}

	return subject;

}    
    
var engine = {
    posts: [],
    img_dir:'/application/public/upload/',
    setMainArticle: function(id)
    {
        $("#main_article").html('<a id="carousel_main_link;" href="'+this.posts[id].link+'"><img width="450px" id="carousel_main_img" style="border: 1px solid rgb(153, 153, 153);" src="'+this.img_dir+this.posts[id].image+'" ></a><div style="width:442px;position:absolute;top:60%;background:black;opacity:0.75;padding:5px" id="carousel_main_text"><h2 style="color:white;font-size:14px">'+this.posts[id].name+'</h2><p style="color:white">'+this.posts[id].description+"</p></div></div>");
    },
    setArticleList:function(id)
    {
        for(p in this.posts)
        {
            if (this.posts[p].id==id)
            {
                $("#post_list").append("<li class='carousel' id='post_"+this.posts[p].id+"' style='font-size:18pt;padding-left:450px;list-style-type:none;background: url(/images/arrow-left-red.png);background-repeat:no-repeat'><b><a style='color:red;text-decoration:underline' href='"+this.posts[p].link+"'>"+this.posts[p].name+"</a></b></li>");
            }
            else
            {
                $("#post_list").append("<li class='carousel' id='post_"+this.posts[p].id+"' style='font-size:18pt;padding-left:450px;list-style-type:none;background: url(/images/arrow-left-red.png);background-repeat:no-repeat'><b><a style='color:black' href='"+this.posts[p].link+"'>"+this.posts[p].name+"</a></b></li>");
            }
        }
    },
    setEvents:function()
    {
        var that = this;
        $(".carousel").hover(
            function(){
                $(".carousel a").css("color","black");
                $(".carousel a").css("text-decoration","none");                
                
                $("a",this).css("color","red");
                $("a",this).css("text-decoration","underline");
                $("a",this).css("color","red");
                var id = str_replace("post_", "", this.id);
                $("#carousel_main_link").attr("href",that.posts[id].link);
                $("#carousel_main_img").attr("src",that.img_dir+that.posts[id].image);
                $("#carousel_main_text p").html(that.posts[id].description);
                $("#carousel_main_text h2").html(that.posts[id].name);
            },
            function()
            {
                $(".carousel a").css("color","black");
                $(".carousel a").css("text-decoration","none");
            }
        );
    },
    init:function(posts)
    {
        for(p in posts)
        {
            this.posts[posts[p].id] = posts[p];
        }
        var id = posts.pop().id;
        this.setMainArticle(id);
        this.setArticleList(id);
        this.setEvents();
    }
};




$(document).ready(function() {
    var articles = $.parseJSON('{articles}');
    engine.init(articles);
});

</script>
<link type="text/css" rel="stylesheet" href="/css/jquery.capty.css"/>

<script type="text/javascript" src="/js/jquery.capty.min.js"></script>
<div style="float:left;width:460px;margin-left: 30px;position: relative;" id="main_article">
</div>
<div style="vertical-align: central;margin-top: 60px">
    <ul id="post_list" >
        
    </ul>
</div>